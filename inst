التسجيل المحتال ابيه يكون للمستخدمين التالين : (الطلاب و المعلمين واولياء الامور فقط )
اما المشرف والمجمع فالتعليمات تحت راجعها 

أريد كتابة Supabase Edge Function (Deno/TypeScript) لإنشاء مستخدمين جدد (طلاب) بدون بريد إلكتروني حقيقي (Username Trick). المنطق المطلوب في الدالة:

تستقبل username, password, complex_id.

تتحقق أولاً من قاعدة البيانات: هل Complex صاحب هذا الآيدي حالته admin_approved = true؟ إذا لا، ترفض العملية.

إذا نعم، تقوم بإنشاء إيميل وهمي بصيغة: username@complex_id.masjed-app.com.

تستخدم supabaseAdmin.auth.admin.createUser لإنشاء الحساب وتفعيله فوراً (email_confirm: true) ووضع username و role: student في الـ User Metadata.

تعيد رسالة نجاح أو خطأ. اكتب لي كود الدالة كاملاً مع تعليقات تشرح كل خطوة.

أريد كود JavaScript لصفحة تسجيل المجمعات (Complex Registration). المتطلبات:

نموذج تسجيل (اسم المجمع، الإيميل، كلمة المرور).

عند الضغط على تسجيل، يستخدم supabase.auth.signUp.

بعد التسجيل الناجح، تظهر واجهة تطلب إدخال كود التحقق (OTP).

دالة verifyOTP تأخذ الكود وتستخدم verifyOtp من Supabase.

إذا تم التحقق بنجاح، يظهر تنبيه: 'تم تأكيد الإيميل، بانتظار موافقة الإدارة للدخول'.

الكود يجب أن يكون Clean Code، مقسماً لدوال، مع تعليقات عربية."
ريد كود JavaScript لصفحة تسجيل دخول الطلاب. المتطلبات:

الواجهة تحتوي على حقل 'اسم المستخدم' (وليس إيميل) وحقل 'كلمة المرور'.

عند الضغط على دخول، الكود يقوم خلف الكواليس بتحويل اسم المستخدم إلى الإيميل الوهمي المتفق عليه (مثلاً البحث عن complex_id الخاص بالطالب ثم تكوين الإيميل). ملاحظة: إذا كان هذا صعباً في تسجيل الدخول، اجعل السيناريو كالتالي: الطالب يدخل username و complex_code (رقم المجمع)، والكود يحولها لـ username@complex_code.masjed-app.com ثم يسجل الدخول بـ signInWithPassword.


